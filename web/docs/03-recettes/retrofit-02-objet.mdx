---
hide_table_of_contents: true
---

# HTTP 2 - Depuis une activité

:::tip
ATTENTION : L'outil principal de débogage pour les appels réseaux est le network inspector dans Android Studio.
1. Cliquer sur Fichier / File ou le symbole  ☰ en haut à gauche
2. Choisir View / Tool Windows / AppInspection
3. Dans la fenêtre AppInspection, choisir l'onglet **Network Inspector**
4. Tu devrais voir apparaître les appels réseaux de ton application
:::

Regarder la recette de base pour les étapes:
- [AndroidManifest.xml](retrofit-01-base?recette-string=AndroidManifest.xml)
- [build.gradle](retrofit-01-base?recette-string=build.gradle)
- [Service.kt](retrofit-01-base?recette-string=Service.kt)
- [RetrofitUtil.kt](retrofit-01-base?recette-string=RetrofitUtil.kt)

Le code de cette recette est disponible [ici](https://github.com/departement-info-cem/4N6-Mobile/tree/main/code/Retrofit/02-GuiAsync).

Nous allons voir comment faire un appel à notre fonction depuis une activité:
- il va s'agir d'un appel asynchrone, autrement dit on n'attend pas la réponse pour continuer l'exécution
- on va rattacher un objet appelé Callback à notre appel pour traiter la réponse
- on aura 3 cas
  - un succès soit une réponse HTTP avec le code 200
  - une réponse du serveur mais avec un code d'erreur
  - un échec à recevoir une réponse

<Tabs queryString="recette-objet">
  <TabItem value="MainActivity.kt" label="MainActivity.kt">

    L'activité suivante utilise le [ViewBinding](https://developer.android.com/topic/libraries/view-binding#kts).

    Si les souvenirs sont loins, revenez à la recette du cours 3N5.

    <GHCode
            repo="4N6-Mobile"
            filePath="code/Retrofit/02-GuiAsync/app/src/main/java/org/depinfo/retrofit_demo/MainActivity.kt"
            startLine="11"
          />

  </TabItem>
  <TabItem value="debug" label="debug">

    Il est important de placer 3 points d'arrêt pour ton débogage:

    ![Retrofit 2](retrofit-2.png)


    Il est aussi important d'utiliser le Network Inspector pour voir les appels réseaux:
    1. Cliquer sur Fichier / File ou le symbole  ☰ en haut à gauche
    2. Choisir View / Tool Windows / AppInspection
    3. Dans la fenêtre AppInspection, choisir l'onglet **Network Inspector**
    4. Tu devrais voir apparaître les appels réseaux de ton application

  </TabItem>
</Tabs>
